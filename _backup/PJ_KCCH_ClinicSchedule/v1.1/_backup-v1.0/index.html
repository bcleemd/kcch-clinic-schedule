<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Image Gallery</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 40px 20px;
            background-color: #f8f9fa;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .gallery-container {
            max-width: 900px;
            width: 100%;
            background-color: white;
            padding: 30px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
            border-radius: 12px;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 40px;
            font-weight: 300;
            letter-spacing: 1px;
        }

        #image-list {
            display: flex;
            flex-direction: column;
            gap: 40px;
        }

        .image-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease, transform 0.6s ease;
        }

        .image-item.loaded {
            opacity: 1;
            transform: translateY(0);
        }

        .image-item img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            border: 1px solid #eee;
        }

        .image-title {
            margin-top: 15px;
            color: #666;
            font-size: 0.95rem;
            background: #f1f3f5;
            padding: 4px 12px;
            border-radius: 20px;
        }

        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        #status-msg {
            text-align: center;
            color: #888;
            margin-top: 20px;
        }
    </style>
</head>

<body>
    <div class="gallery-container">
        <h1>Clinic Schedule Gallery</h1>
        <div id="loader" class="loader"></div>
        <div id="image-list"></div>
        <div id="status-msg"></div>
    </div>

    <script>
        async function loadImages() {
            const imageList = document.getElementById('image-list');
            const loader = document.getElementById('loader');
            const statusMsg = document.getElementById('status-msg');
            const imageExtensions = ['.jpg', '.jpeg', '.png', '.gif', '.webp'];

            try {
                // Determine if we are on GitHub Pages
                const hostname = window.location.hostname;
                const pathname = window.location.pathname;

                let files = [];

                if (hostname.includes('github.io')) {
                    // GitHub Pages: Use GitHub API
                    const parts = hostname.split('.');
                    const owner = parts[0];
                    const repo = pathname.split('/')[1];
                    const apiUrl = `https://api.github.com/repos/${owner}/${repo}/contents/`;

                    const response = await fetch(apiUrl);
                    if (!response.ok) throw new Error('Failed to fetch file list from GitHub');
                    files = await response.json();

                    // Filter images and format
                    files = files
                        .filter(file => file.type === 'file' && imageExtensions.some(ext => file.name.toLowerCase().endsWith(ext)))
                        .map(file => ({ name: file.name, url: file.download_url }));
                } else {
                    // Local testing or other: Hardcoded or simple discovery if server allows directory listing
                    // For now, since we can't do local directory listing via standard JS without a server,
                    // we'll show a message or try to fetch a known file.
                    statusMsg.textContent = "Running locally. Auto-discovery works best on GitHub Pages. Showing current known files...";
                    files = [
                        { name: '2026-01-ClinicSchedule.jpg', url: '2026-01-ClinicSchedule.jpg' },
                        { name: '2026-02-ClinicSchedule.png', url: '2026-02-ClinicSchedule.png' }
                    ];
                }

                loader.style.display = 'none';

                if (files.length === 0) {
                    statusMsg.textContent = "No images found in the directory.";
                    return;
                }

                files.sort((a, b) => b.name.localeCompare(a.name)); // Sort descending (newest first usually)

                files.forEach((file, index) => {
                    const item = document.createElement('div');
                    item.className = 'image-item';
                    item.innerHTML = `
                        <img src="${file.url}" alt="${file.name}" loading="lazy">
                        <div class="image-title">${file.name}</div>
                    `;
                    imageList.appendChild(item);

                    // Staggered fade-in effect
                    setTimeout(() => {
                        item.classList.add('loaded');
                    }, index * 100);
                });

            } catch (error) {
                console.error(error);
                loader.style.display = 'none';
                statusMsg.textContent = "Error loading images. Please ensure the repository is public or try reloading.";
                statusMsg.style.color = "#e74c3c";
            }
        }

        window.onload = loadImages;
    </script>
</body>

</html>